<% content_for :before_main do %>
  <%= render AppBacklinkComponent.new(
        href: @campaign.active ? campaign_path(@campaign) : previous_wizard_path,
        name: @campaign.active ? @campaign.name : "#{@previous_step} page of programme creation",
      ) %>
<% end %>

<%= form_with model: @campaign, url: wizard_path, method: :put do |f| %>
  <%= f.govuk_error_summary %>

  <%= h1 @campaign.active ? "Edit programme" : "Check and confirm" %>

  <%= render AppCardComponent.new do |card| %>
    <% card.with_heading { @campaign.active ? "Programme details" : "New programme details" } %>

    <%= govuk_summary_list do |summary_list| %>
      <%= summary_list.with_row do |row| %>
        <%= row.with_key { "Name" } %>
        <%= row.with_value { @campaign.name } %>
        <%= row.with_action(text: "Change", href: campaign_edit_path(@campaign, :details), visually_hidden_text: "name") %>
      <% end %>

      <%= summary_list.with_row do |row| %>
        <%= row.with_key { "Programme type" } %>
        <%= row.with_value { @campaign.human_enum_name(:type) } %>
        <%= row.with_action(text: "Change", href: campaign_edit_path(@campaign, :details), visually_hidden_text: "programme type") %>
      <% end %>

      <%= summary_list.with_row do |row| %>
        <%= row.with_key { "Academic year" } %>
        <%= row.with_value { campaign_academic_year(@campaign) } %>
        <%= row.with_action(text: "Change", href: campaign_edit_path(@campaign, :details), visually_hidden_text: "academic year") %>
      <% end %>

      <%= summary_list.with_row do |row| %>
        <%= row.with_key { "Start date" } %>
        <%= row.with_value { @campaign.start_date.to_fs(:long) } %>
        <%= row.with_action(text: "Change", href: campaign_edit_path(@campaign, :dates), visually_hidden_text: "start date") %>
      <% end %>

      <%= summary_list.with_row do |row| %>
        <%= row.with_key { "End date" } %>
        <%= row.with_value { @campaign.end_date.to_fs(:long) } %>
        <%= row.with_action(text: "Change", href: campaign_edit_path(@campaign, :dates), visually_hidden_text: "end date") %>
      <% end %>

      <% if @campaign.active %>
        <%= summary_list.with_row do |row| %>
          <%= row.with_key { "Vaccines" } %>
          <%= row.with_value { @campaign.vaccines.map(&:brand).join("<br>").html_safe } %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <%= f.govuk_submit "Save changes" %>
<% end %>
