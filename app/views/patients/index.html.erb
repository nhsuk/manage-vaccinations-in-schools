<% if current_team.has_poc_access? %>
  <%= h1 t(".title"), size: "xl" %>
<% else %>
  <%= h1 t(".upload_only_long_title"), size: "xl" %>
<% end %>

<div class="nhsuk-grid-row">
  <div class="app-grid-column-filters">
    <%= render AppPatientSearchFormComponent.new(
          @form,
          url: patients_path,
          current_team:,
          heading_level: 2,
          programmes: current_team.programmes,
          consent_statuses: current_team.has_upload_access_only? ? [] : %w[no_response given refused conflicts],
          programme_statuses: current_team.has_upload_access_only? ? [] : @programme_statuses,
          triage_statuses: current_team.has_upload_access_only? ? [] : %w[required delay_vaccination do_not_vaccinate safe_to_vaccinate],
          vaccination_statuses: current_team.has_upload_access_only? ? [] : Patient::VaccinationStatus.statuses.keys,
          year_groups: current_team.year_groups,
          show_aged_out_of_programmes: current_team.has_upload_access_only? ? false : true,
        ) %>
  </div>

  <div class="app-grid-column-results">
    <% if @search_params_present %>
      <%= render AppSearchResultsComponent.new(@pagy, label: "children") do %>
        <% @patients.each do |patient| %>
          <%= render AppPatientSearchResultCardComponent.new(
                patient,
                link_to: patient_path(patient),
                current_team:,
                programmes: @form.programmes,
                show_programme_status: !current_team.has_upload_access_only?,
                show_consent_status: @form.consent_statuses.present?,
                show_nhs_number: true,
                show_school: true,
                show_triage_status: @form.triage_status.present?,
                show_postcode: current_team.has_upload_access_only?,
              ) %>
        <% end %>
      <% end %>
    <% else %>
       <%= render AppSearchResultsComponent.new(@pagy, label: "children", no_results_text: "Search for a child or use filters to see children matching your selection.") %>
    <% end %>
  </div>
</div>
