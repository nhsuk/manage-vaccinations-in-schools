<%= form_with model: form, url:, method:, builder: do |f| %>
  <% content_for(:before_content) { f.govuk_error_summary } %>

    <%= f.govuk_radio_buttons_fieldset :status_and_vaccine_method, **fieldset_options do %>
      <% form.safe_to_vaccinate_options.each do |option| %>
        <%= f.govuk_radio_button :status_and_vaccine_method, option do %>
        <% if show_psd_options?(option) %>
          <%= f.govuk_radio_buttons_fieldset :psd_action,
                                             legend: { text: "Do you want to add a PSD?", size: "s" } do %>
            <%= f.govuk_radio_button :add_psd, "true", label: { text: "Yes" } %>
            <%= f.govuk_radio_button :add_psd, "false", label: { text: "No" } %>
          <% end %>
        <% end %>
      <% end %>
      <% end %>
      <%= f.govuk_radio_divider %>
      <% form.other_options.each do |option| %>
        <%= f.govuk_radio_button :status_and_vaccine_method, option %>
      <% end %>
    <% end %>

  <%= f.govuk_text_area :notes, label: { text: "Triage notes (optional)" }, rows: 5 %>

  <%= f.govuk_submit continue ? "Continue" : "Save triage" %>
<% end %>
