<%= render AppCardComponent.new(feature: true) do |card| %>
  <% card.with_heading(level: 3) do %>
    <%= pluralize(imports.count, "import") %>
  <% end %>

  <%= govuk_table(html_attributes: {
                    class: "nhsuk-table-responsive",
                  }) do |table| %>
    <% table.with_head do |head| %>
      <% head.with_row do |row| %>
        <% row.with_cell(text: "Imported on") %>
        <% unless @team.has_national_reporting_access? %>
          <% row.with_cell(text: "Type") %>
        <% end %>
        <% row.with_cell(text: "Status") %>
        <% row.with_cell(text: "Records", numeric: true) unless @uploaded_files %>
      <% end %>
    <% end %>

    <% table.with_body do |body| %>
      <% imports.each do |import| %>
        <% body.with_row do |row| %>
          <% row.with_cell do %>
            <span class="nhsuk-table-responsive__heading">Imported on</span>
            <%= link_to import.created_at.to_fs(:long), path(import) %>
            <br />
            <span class="nhsuk-u-secondary-text-color nhsuk-u-font-size-16">
              <%= import.csv_filename %>
            </span>
          <% end %>
          <% unless @team.has_national_reporting_access? %>
            <% row.with_cell do %>
              <span class="nhsuk-table-responsive__heading">Type</span>
              <%= record_type(import) %>
              <% if import.is_a?(ClassImport) %>
                <br />
                <span class="nhsuk-u-secondary-text-colour nhsuk-u-font-size-16">
                  <%= import.location.name %>
                </span>
              <% end %>
            <% end %>
          <% end %>
          <% row.with_cell do %>
            <span class="nhsuk-table-responsive__heading">Status</span>
            <%= render AppImportStatusComponent.new(import: import,
                                                    break_tag: true) %>
          <% end %>
          <% unless @uploaded_files %>
            <% row.with_cell(numeric: true) do %>
              <span class="nhsuk-table-responsive__heading">Records</span>
                <%= import.records_count %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
